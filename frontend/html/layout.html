<!DOCTYPE html>
{% load static %}
<html lang="ru">
<head>
    <title>{% block title %}–í–∞—Å—Ç—Ä–∏–∫.–ö–ª—É–± ü§ò‚úñÔ∏èüë©‚Äçüíª‚Äç{% endblock %}</title>
    {% block fonts %}
        {% include "common/fonts.html" %}
    {% endblock %}
    {% block meta %}
        {% include "common/meta.html" %}
    {% endblock %}
    <script>
        // check and set theme before render. After render the theme switch is controlled by the <theme-switcher> component
        // the component contains the same theme detection code as below. If you change this code, update the theme too
        const theme = localStorage.getItem('theme') ?? "auto";
        const currentTheme = theme === "auto" ? (matchMedia("(prefers-color-scheme: light)").matches ? "light" : "dark") : theme;
        document.documentElement.setAttribute('theme', currentTheme);
    </script>

    {% block feeds %}
    <link rel="alternate" type="application/rss+xml"
          title="–í–∞—Å—Ç—Ä–∏–∫.–ö–ª—É–±: –ù–æ–≤—ã–µ –ø–æ—Å—Ç—ã"
          href="{{ settings.APP_HOST }}{% url "rss" %}" />

    <link rel="alternate" title="–í–∞—Å—Ç—Ä–∏–∫.–ö–ª—É–±: JSON Feed"
          type="application/feed+json"
          href="{{ settings.APP_HOST }}{% url "json_feed" %}" />
    ‚Äç{% endblock %}

    {% block og_tags %}
        {% include "common/og.html" %}
    {% endblock %}

    {% include "common/favicon.html" %}
    {% include "common/css.html" %}
    {% block css %}{% endblock %}
</head>
<body>

{% block body %}
    <main id="app">
        {% block menu %}
            {% if me %}
                {% include "common/menu-full.html" %}
            {% else %}
                {% include "common/menu-simplified.html" %}
            {% endif %}
        {% endblock %}
        {% block content %}
        {% endblock %}
    </main>
{% endblock %}

{% block footer %}
    <footer class="footer" id="footer">
        <div class="footer-left">
            <a href="{% url "docs" "about" %}">–û –ö–ª—É–±–µ</a> &nbsp;&middot;&nbsp;

            <a href="{{ settings.VALUES_GUIDE_URL }}">–ù–∞—à–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏</a> &nbsp;&middot;&nbsp;

            <a href="{% url "docs" "privacy_policy" %}">–ü–æ–ª–∏—Ç–∏–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏</a> &nbsp;&middot;&nbsp;

            <a href="{% url "docs" "contact" %}">–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏</a>

            <br><br>

            {% if request.me %}
                <a href="{% url "invites" %}">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞</a> &nbsp;&middot;&nbsp;
            {% endif %}

            <a href="https://github.com/vas3k/vas3k.club">–û–ø–µ–Ω—Å–æ—Ä—Å</a> &nbsp;&middot;&nbsp;

            <a href="{% url "docs" "blocked_dolor" %}">–û–ø–ª–∞—Ç–∞ –∏–∑ –†–æ—Å—Å–∏–∏</a>

            <br><br>

            CC BY-SA
        </div>
        <div class="footer-right">
            <theme-switcher></theme-switcher>

            {% if me %}
                <form method="POST" action="{% url "logout" %}" class="footer-logout">
                    {% csrf_token %}
                    <button type="submit" class="footer-logout-button">–í—ã–π—Ç–∏&nbsp;<i class="fas fa-sign-out-alt"></i></button>
                </form>
            {% endif %}
        </div>
    </footer>
{% endblock %}

{% include "common/js.html" %}
{% block js %}{% endblock %}

<style>
    /* === CRT Overlay Styles === */
.crt-overlay {
  position: fixed;
  pointer-events: none;
  z-index: 9999;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  backdrop-filter: contrast(1.2) brightness(1.05);
  mask-image: radial-gradient(circle at center, black 60%, transparent 100%);
  overflow: hidden;
}

/* Animated Scanlines */
.crt-overlay::before {
  content: '';
  position: absolute;
  width: 100%;
  height: 200%;
  background-image: repeating-linear-gradient(
    to bottom,
    rgba(0, 0, 0, 0.08) 0px,
    rgba(0, 0, 0, 0.08) 1px,
    transparent 2px
  );
  animation: scanlines-scroll 180s linear infinite;
  mix-blend-mode: overlay;
}

/* Subtle RGB vertical mask */
.crt-overlay::after {
  content: '';
  position: absolute;
  width: 100%;
  height: 100%;
  background-image: repeating-linear-gradient(
    to right,
    rgba(255, 0, 0, 0.03),
    rgba(0, 255, 0, 0.03),
    rgba(0, 0, 255, 0.03)
  );
  background-size: 3px 100%;
  mix-blend-mode: screen;
}

/* Animation keyframes for upward motion */
@keyframes scanlines-scroll {
  0% { transform: translateY(0%); }
  100% { transform: translateY(-50%); }
}

</style>

<script>
    function applyCRTOverlay() {
  const overlay = document.createElement('div');
  overlay.className = 'crt-overlay';
  document.body.appendChild(overlay);
  console.log('üñ•Ô∏è CRT overlay applied');
}

window.addEventListener('load', applyCRTOverlay);

</script>

</body>
</html>
